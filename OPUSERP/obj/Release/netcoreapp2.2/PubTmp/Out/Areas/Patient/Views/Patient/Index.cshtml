@model PatientViewModel
@{
    ViewData["Title"] = "Recipient's Info";
    Layout = "~/Areas/Patient/Views/Shared/_PatientForm.cshtml";
}

@section StylePatient{
    <style>
        .redStar {
            color: red;
        }
    </style>
}
<div class="card" style="width: 100%;">
    <div class="card-body">
        <hr>
        <div class="container">
            <form asp-area="Patient" id="FormId" asp-controller="Patient" asp-action="Patient" method="post" data-parsley-validate="parsley">
                <div asp-validation-summary="All" class="text-danger"></div>

                <input type="hidden" id="resourceId" name="resourceId" value="0">
                <input type="hidden" id="contactId" name="contactId" value="0">

                <div class="row">
                    <div class="col-sm-6">
                        <div class="form-group row">
                            <label for="patientCode" class="col-sm-4 col-form-label">Recipient's Code</label>
                            <div class="col-sm-8">
                                <input type="text" class="form-control" id="patientCode" name="patientCode" value="@ViewBag.patientCode" readonly>
                            </div>
                        </div>
                        <div class="form-group row">
                            <label for="patientName" class="col-sm-4 col-form-label">Recipient's Name <span class="redStar">*</span></label>
                            <div class="col-sm-8">
                                <input type="text" class="form-control" id="patientName" name="patientName" data-parsley-required="true" required>
                                @{
                                    var id = 0;
                                    if (@ViewBag.patientId == null)
                                    {
                                        id = 0;
                                    }
                                    else
                                    {
                                        id = ViewBag.patientId;
                                    }
                                    <input type="hidden" name="patientId" id="patientId" value="@id">
                                }

                            </div>
                        </div>
                        <div class="form-group row">
                            <label for="fatherName" class="col-sm-4 col-form-label">Father Name</label>
                            <div class="col-sm-8">
                                <input type="text" class="form-control" id="fatherName" name="fatherName" required>
                            </div>
                        </div>
                        <div class="form-group row">
                            <label for="motherName" class="col-sm-4 col-form-label">Mother Name</label>
                            <div class="col-sm-8">
                                <input type="text" class="form-control" id="motherName" name="motherName" required>
                            </div>
                        </div>
                        <div class="form-group row">
                            <label for="bloodGroup" class="col-sm-4 col-form-label">Blood Group</label>
                            <div class="col-sm-8">
                                <select class="form-control" id="bloodGroup" name="bloodGroup">
                                    <option value="">Select</option>
                                    <option value="O-">O-</option>
                                    <option value="O+">O+</option>
                                    <option value="A-">A-</option>
                                    <option value="A+">A+</option>
                                    <option value="B-">B-</option>
                                    <option value="B+">B+</option>
                                    <option value="AB-">AB-</option>
                                    <option value="AB+">AB+</option>
                                </select>
                            </div>
                        </div>
                        <div class="form-group row">
                            <label for="ageInYears" class="col-sm-4 col-form-label">Age <span class="redStar">*</span></label>
                            <div class="col-sm-3">
                                <input type="number" class="form-control" id="ageInYears" name="ageInYears" data-parsley-required="true">Years
                            </div>
                            <div class="col-sm-3">
                                <input type="number" class="form-control" id="ageInMonths" name="ageInMonths">Months
                            </div>
                            <div class="col-sm-2">
                                <input type="number" class="form-control" id="ageInDays" name="ageInDays">Days
                            </div>
                        </div>
                    </div>
                    <div class="col-sm-6">
                        <div class="form-group row">
                            <label for="gender" class="col-sm-4 col-form-label">Gender</label>
                            <div class="col-sm-8">
                                <select class="form-control" id="gender" name="gender">
                                    <option value="">Select Gender</option>
                                    <option value="Male">Male</option>
                                    <option value="Female">Female</option>
                                </select>
                            </div>
                        </div>
                        <div class="form-group row">
                            <label for="nationalId" class="col-sm-4 col-form-label">National Id</label>
                            <div class="col-sm-8">
                                <input type="text" class="form-control" id="nationalId" name="nationalId">
                            </div>
                        </div>
                        <div class="form-group row">
                            <label for="patientMobile" class="col-sm-4 col-form-label">Mobile</label>
                            <div class="col-sm-8">
                                <input type="text" class="form-control" id="patientMobile" name="patientMobile">
                            </div>
                        </div>
                        <div class="form-group row">
                            <label for="patientPhone" class="col-sm-4 col-form-label">Phone</label>
                            <div class="col-sm-8">
                                <input type="text" class="form-control" id="patientPhone" name="patientPhone">
                            </div>
                        </div>
                        <div class="form-group row">
                            <label for="patientEmail" class="col-sm-4 col-form-label">Email</label>
                            <div class="col-sm-8">
                                <input type="text" class="form-control" id="patientEmail" name="patientEmail">
                            </div>
                        </div>
                        <div class="form-group row">
                            <label for="maritalStatus" class="col-sm-4 col-form-label">Marital Status </label>
                            <div class="col-sm-8">
                                <select class="form-control" id="maritalStatus" name="maritalStatus">
                                    <option value="">Select</option>
                                    <option value="Married">Married</option>
                                    <option value="Unmarried">Unmarried</option>
                                    <option value="Widow">Widow</option>
                                    <option value="Separated">Separated</option>
                                </select>
                            </div>
                        </div>
                    </div>
                </div>
                <hr />
                <button type="button" id="submit" value="Submit" class="btn btn-success btn-lg" style="float:right; margin-top:5px;"><i class="fas fa-save"></i></button>
            </form>

        </div>
    </div>
</div>


@*<input type="text" id="abc" name="abc" value="" />
<button onclick="myapp()">save</button>

<div id="read">

</div>*@


@section ScriptsPatient{
    <script>

         $('#submit').click(function () {
		console.log($('#FormId').serializeArray());
		var data = $('#FormId').serializeArray();

		console.log(data[0].value)
		swal({
			title: 'Are you sure?', text: 'Do you want to submit this record!', type: 'warning', showCancelButton: true, confirmButtonColor: '#3085d6', cancelButtonColor: '#d33', confirmButtonText: 'Yes, submit it!'
		}).then(function () {
			$.ajax({
                url: '@Url.Action("Patient", "Patient")',
				type: 'POST',
				data: data
			}).done(function () {
                if (data[0].value == 0) {
                    swal('success', 'Saved Successfully!', 'success').then(function () {
                        location.reload();
                    });
                }
                else {
                    swal('success', 'Updated Successfully!', 'success').then(function () {
                        location.reload();
                    });;
                }
			}).fail(function () {
				swal('warning', 'Failed!', 'warning');
			})
		});
	})



        $(document).ready(function () {

            $("#patient").addClass("active");

            let patientId = parseInt(@ViewBag.patientId) ? parseInt(@ViewBag.patientId) : 0;
            if (patientId != null || patientId != 0) {
                Common.Ajax('GET', '/Patient/Patient/GetPatientInfoById/?id=' + patientId, [], 'json', ajaxGetPatientInfoById);
            }
        });

        function ajaxGetPatientInfoById(response) {

            $("#patientName").val(response?.patientName);
            $("#fatherName").val(response?.fatherName);
            $("#motherName").val(response?.motherName);
            $("#ageInYears").val(response?.ageInYears);
            $("#ageInMonths").val(response?.ageInMonths);
            $("#ageInDays").val(response?.ageInDays);
            $("#bloodGroup").val(response?.bloodGroup);
            $("#maritalStatus").val(response?.maritalStatus);
            $("#gender").val(response?.gender);
            $("#nationalId").val(response?.nationalId);
            $("#patientMobile").val(response?.patientMobile);
            $("#patientPhone").val(response?.patientPhone);
            $("#patientEmail").val(response?.patientEmail);
            $("#resourceId").val(response?.resourceId);
            $("#contactId").val(response?.contactId);
        }

    </script>
}



